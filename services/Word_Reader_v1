â€œâ€â€
Belirtilen word dosyasÄ±ndan tablo okuma iÅŸlemlerini yapar
â€œâ€â€
import pandas as pd
from docx import Document
from typing import List
import os

class WordReaderService:
def **init**(self):
self.current_document = None
self.operation_no = â€œâ€
self.part_no = â€œâ€

```
def load_document(self, file_path: str) -> bool:
    """Word DosyasÄ±nÄ± YÃ¼kler"""
    try:
        doc = Document(file_path)
        self.current_document = doc
        print(f"âœ“ Word dosyasÄ± yÃ¼klendi: {file_path}")
        
        # Dosya adÄ±ndan bilgileri Ã§Ä±kar
        self.extract_file_info(file_path)
        
        return True
    except Exception as e:
        print(f"HATA: Word dosyasÄ± yÃ¼klenemedi - {e}")
        return False

def extract_file_info(self, file_path: str) -> dict:
    """
    Dosya yolundan operation_no ve part_no bilgilerini Ã§Ä±karÄ±r
    
    Args:
        file_path: Dosya yolu
        
    Returns:
        dict: {'operation_no': str, 'part_no': str}
    """
    try:
        # Dosya adÄ±nÄ± al (uzantÄ±sÄ±z)
        file_name = os.path.splitext(os.path.basename(file_path))[0]
        print(f"Dosya adÄ± analiz ediliyor: {file_name}")
        
        # FarklÄ± ayÄ±rÄ±cÄ± tÃ¼rlerini kontrol et
        if "_" in file_name:
            # Underscore ile ayrÄ±lmÄ±ÅŸ: "PartName_OperationNo"
            parts = file_name.split("_")
            if len(parts) >= 2:
                self.part_no = parts[0].strip()
                self.operation_no = parts[1].strip()
                print(f"  âœ“ Underscore formatÄ±: Part={self.part_no}, Operation={self.operation_no}")
            else:
                self.part_no = file_name
                self.operation_no = "00"
                print(f"  âš  Underscore var ama tek parÃ§a: Part={self.part_no}")
                
        elif " - " in file_name:
            # Dash ile ayrÄ±lmÄ±ÅŸ: "PartName - OperationNo"
            parts = file_name.split(" - ")
            if len(parts) >= 2:
                self.part_no = parts[0].strip()
                self.operation_no = parts[1].strip()
                print(f"  âœ“ Dash formatÄ±: Part={self.part_no}, Operation={self.operation_no}")
            else:
                self.part_no = file_name
                self.operation_no = "00"
                
        elif " " in file_name:
            # Space ile ayrÄ±lmÄ±ÅŸ: "PartName OperationNo"
            parts = file_name.split(" ")
            if len(parts) >= 2:
                self.part_no = parts[0].strip()
                self.operation_no = parts[1].strip()
                print(f"  âœ“ Space formatÄ±: Part={self.part_no}, Operation={self.operation_no}")
            else:
                self.part_no = file_name
                self.operation_no = "00"
        else:
            # AyÄ±rÄ±cÄ± yok - tÃ¼m dosya adÄ± part_no olarak kullanÄ±lÄ±r
            self.part_no = file_name
            self.operation_no = "00"
            print(f"  â—‹ AyÄ±rÄ±cÄ± bulunamadÄ±: Part={self.part_no}, Operation={self.operation_no}")
        
        # BoÅŸ deÄŸerleri temizle
        if not self.part_no:
            self.part_no = "Unknown"
        if not self.operation_no:
            self.operation_no = "00"
            
        print(f"ğŸ“ Final sonuÃ§: Part No = '{self.part_no}', Operation No = '{self.operation_no}'")
        
        return {
            'part_no': self.part_no,
            'operation_no': self.operation_no
        }
        
    except Exception as e:
        print(f"HATA: Dosya bilgisi Ã§Ä±karÄ±mÄ±nda hata - {e}")
        self.part_no = "Unknown"
        self.operation_no = "00"
        return {
            'part_no': self.part_no,
            'operation_no': self.operation_no
        }

def get_file_info(self) -> dict:
    """
    Ã‡Ä±karÄ±lan dosya bilgilerini dÃ¶ndÃ¼rÃ¼r
    
    Returns:
        dict: {'part_no': str, 'operation_no': str}
    """
    return {
        'part_no': self.part_no,
        'operation_no': self.operation_no
    }

def extract_tables(self, file_path: str) -> List:
    """
    Word iÃ§erisindeki TablolarÄ± Veri Toplar ve Liste Olarak DÃ¶ndÃ¼rÃ¼r
    """
    print("Veri iÅŸleme baÅŸlÄ±yor...")
    
    # Header'Ä± ilk eleman olarak liste iÃ§inde tanÄ±mla
    headers = ["ITEM NO", "DIMENSION", "ACTUAL", "BADGE", "TOOLING", "REMARKS", "B/P ZONE", "INSP. LEVEL"]
    extracted_data = [headers]  # Ä°lk eleman header LÄ°STESÄ°
    
    try:
        # Word dokÃ¼manÄ±nÄ± yÃ¼kle
        word_document = self.load_document(file_path=file_path)
        if not word_document:
            return []
        
        tables = self.current_document.tables
        print(f"  {len(tables)} tablo bulundu")
        
        for table_idx, table in enumerate(tables):
            print(f"  Tablo {table_idx + 1} iÅŸleniyor...")
            
            for row in table.rows:
                row_data = []
                for cell in row.cells:
                    # HÃ¼credeki tÃ¼m paragraflarÄ± birleÅŸtir
                    cell_text = '\n'.join([p.text for p in cell.paragraphs])
                    row_data.append(cell_text)
                
                # DEBUG: SatÄ±r verilerini kontrol et
                print(f"    Debug - row_data uzunluÄŸu: {len(row_data)}")
                if len(row_data) > 0:
                    print(f"    Debug - Ä°lk element: '{row_data[0]}'")
                
                # Filtreleme mantÄ±ÄŸÄ±
                if (len(row_data) > 2 and 
                    row_data[0].startswith("KN") and 
                    not row_data[1].strip().endswith("Inch")):
                    
                    # SatÄ±rÄ± 8 kolona pad et veya kÄ±rp
                    padded_row = row_data + [''] * (len(headers) - len(row_data))
                    padded_row = padded_row[:len(headers)]
                    
                    extracted_data.append(padded_row)  # LÄ°STE ekleniyor
                    print(f"    âœ“ SatÄ±r eklendi: {row_data[0]} (kolon sayÄ±sÄ±: {len(padded_row)})")
        
        print(f"âœ“ Toplam {len(extracted_data) - 1} karakter Ã§Ä±karÄ±ldÄ±")
        print(f"Header: {extracted_data[0]}")
        if len(extracted_data) > 1:
            print(f"Ä°lk veri satÄ±rÄ±: {extracted_data[1]} (uzunluk: {len(extracted_data[1])})")
        
        return extracted_data
        
    except Exception as e:
        print(f"HATA: Tablo Ã§Ä±karma iÅŸleminde sorun: {e}")
        return []

def create_organized_path(self, base_path: str, project: str, serial_no: str) -> str:
    """
    Organize edilmiÅŸ dosya yolu oluÅŸturur
    
    Args:
        base_path: Ana kaydetme yolu
        project: Proje adÄ±  
        serial_no: Seri numarasÄ±
        
    Returns:
        str: Organize edilmiÅŸ tam dosya yolu
    """
    try:
        # KlasÃ¶r yapÄ±sÄ±: base_path/Project/SerialNo/PartNo_OperationNo_measurements.docx
        folder_path = os.path.join(base_path, project, serial_no)
        
        # KlasÃ¶rleri oluÅŸtur
        os.makedirs(folder_path, exist_ok=True)
        print(f"âœ“ KlasÃ¶r yapÄ±sÄ± oluÅŸturuldu: {folder_path}")
        
        # Dosya adÄ±nÄ± oluÅŸtur
        file_name = f"{self.part_no}_{self.operation_no}_measurements.docx"
        full_path = os.path.join(folder_path, file_name)
        
        print(f"ğŸ“ Hedef dosya yolu: {full_path}")
        return full_path
        
    except Exception as e:
        print(f"HATA: Organize yol oluÅŸturma hatasÄ± - {e}")
        # Fallback: Basit yol
        file_name = f"{self.part_no}_{self.operation_no}_measurements.docx"
        return os.path.join(base_path, file_name)
```
