class NavigableMainWindow(ctk.CTk):
â€œâ€â€œNavigate edilebilir ana pencere + Word Save As + Proje organizasyonuâ€â€â€

```
def __init__(self):
    super().__init__()
    
    # Pencere ayarlarÄ±
    self.title("Teknik Resim Karakter Okuyucu - Navigate Edilebilir")
    self.geometry("1400x900")
    
    # Veri
    self.karakterler: List[TeknikResimKarakteri] = []
    self.current_index = 0
    self.current_file_path: Optional[str] = None
    
    # Word Save As servisi
    self.word_save_service = WordSaveAsService()
    
    # YENÄ°: Proje bilgileri
    self.project_info = None
    
    self.setup_ui()
    
    # Klavye shortcut'larÄ±
    self.bind('<Left>', lambda e: self.navigate_to(self.current_index - 1))
    self.bind('<Right>', lambda e: self.navigate_to(self.current_index + 1))
    self.focus_set()  # Klavye focus'u iÃ§in

def setup_ui(self):
    """Ana UI'Ä± oluÅŸturur"""
    # Grid ayarlarÄ± - 2 eÅŸit kolon
    self.grid_columnconfigure(0, weight=1)  # Sol panel
    self.grid_columnconfigure(1, weight=1)  # SaÄŸ panel
    self.grid_rowconfigure(1, weight=1)     # Ana iÃ§erik
    
    # Ãœst panel - Dosya iÅŸlemleri
    self.create_top_panel()
    
    # Sol panel - Tek karakter gÃ¶rÃ¼nÃ¼mÃ¼
    self.create_left_panel()
    
    # SaÄŸ panel - DokÃ¼man gÃ¶rÃ¼ntÃ¼leyici
    self.create_right_panel()
    
    # Alt panel - Ä°statistikler
    self.create_bottom_panel()

def create_top_panel(self):
    """Ãœst panel - dosya seÃ§me + proje bilgileri"""
    top_frame = ctk.CTkFrame(self)
    top_frame.grid(row=0, column=0, columnspan=2, sticky="ew", padx=10, pady=10)
    
    # Sol taraf - Dosya iÅŸlemleri
    left_section = ctk.CTkFrame(top_frame, fg_color="transparent")
    left_section.pack(side="left", fill="x", expand=True)
    
    # Dosya seÃ§ butonu
    self.file_button = ctk.CTkButton(
        left_section,
        text="ğŸ“ Word DosyasÄ± SeÃ§",
        command=self.select_file,
        height=40,
        font=ctk.CTkFont(size=14),
        width=150
    )
    self.file_button.pack(side="left", padx=10, pady=10)
    
    # Dosya yolu gÃ¶sterici
    self.file_path_label = ctk.CTkLabel(
        left_section,
        text="Dosya seÃ§ilmedi",
        font=ctk.CTkFont(size=12)
    )
    self.file_path_label.pack(side="left", padx=10, pady=10)
    
    # SaÄŸ taraf - Proje bilgileri gÃ¶stergesi (YENÄ°)
    right_section = ctk.CTkFrame(top_frame, fg_color="transparent")
    right_section.pack(side="right", padx=10)
    
    # Proje bilgileri frame
    self.project_frame = ctk.CTkFrame(right_section, fg_color="#2d3748")
    self.project_frame.pack(side="left", padx=5)
    
    project_title = ctk.CTkLabel(
        self.project_frame,
        text="ğŸ“‹ Proje Bilgileri",
        font=ctk.CTkFont(size=12, weight="bold"),
        text_color="#81c784"
    )
    project_title.pack(padx=10, pady=(5, 2))
    
    self.project_info_label = ctk.CTkLabel(
        self.project_frame,
        text="HenÃ¼z bilgi yok",
        font=ctk.CTkFont(size=10),
        text_color="gray"
    )
    self.project_info_label.pack(padx=10, pady=(0, 5))
    
    # Ä°ÅŸle butonu
    self.process_button = ctk.CTkButton(
        right_section,
        text="ğŸš€ DosyayÄ± YÃ¼kle",
        command=self.process_file,
        height=40,
        font=ctk.CTkFont(size=14, weight="bold"),
        state="disabled",
        fg_color="#4caf50",
        hover_color="#388e3c"
    )
    self.process_button.pack(side="right", padx=5, pady=10)

def create_left_panel(self):
    """Sol panel - tek karakter gÃ¶rÃ¼nÃ¼mÃ¼"""
    left_frame = ctk.CTkFrame(self)
    left_frame.grid(row=1, column=0, sticky="nsew", padx=(10, 5), pady=10)
    left_frame.grid_rowconfigure(0, weight=1)
    left_frame.grid_columnconfigure(0, weight=1)
    
    # Karakter gÃ¶rÃ¼nÃ¼mÃ¼
    self.karakter_view = SingleKarakterView(
        left_frame,
        on_update_callback=self.on_karakter_updated
    )
    self.karakter_view.grid(row=0, column=0, sticky="nsew", padx=10, pady=(10, 5))
    
    # Navigasyon paneli
    self.navigation_panel = NavigationPanel(
        left_frame,
        on_navigate_callback=self.navigate_to
    )
    self.navigation_panel.grid(row=1, column=0, sticky="ew", padx=10, pady=(5, 10))

def create_right_panel(self):
    """SaÄŸ panel - dokÃ¼man gÃ¶rÃ¼ntÃ¼leyici"""
    right_frame = ctk.CTkFrame(self)
    right_frame.grid(row=1, column=1, sticky="nsew", padx=(5, 10), pady=10)
    right_frame.grid_rowconfigure(0, weight=1)
    right_frame.grid_columnconfigure(0, weight=1)
    
    # DokÃ¼man gÃ¶rÃ¼ntÃ¼leyici
    self.document_viewer = DocumentViewer(right_frame)
    self.document_viewer.grid(row=0, column=0, sticky="nsew", padx=10, pady=10)

def create_bottom_panel(self):
    """Alt panel - istatistikler ve kaydetme"""
    bottom_frame = ctk.CTkFrame(self)
    bottom_frame.grid(row=2, column=0, columnspan=2, sticky="ew", padx=10, pady=10)
    
    # Ä°statistik labelÄ±
    self.stats_label = ctk.CTkLabel(
        bottom_frame,
        text="Ä°statistikler burada gÃ¶rÃ¼necek",
        font=ctk.CTkFont(size=12)
    )
    self.stats_label.pack(side="left", padx=10, pady=10)
    
    # Kaydetme butonlarÄ±
    save_frame = ctk.CTkFrame(bottom_frame, fg_color="transparent")
    save_frame.pack(side="right", padx=10, pady=5)
    
    # Word Save As butonu - GÃœNCELLENEN!
    word_save_button = ctk.CTkButton(
        save_frame,
        text="ğŸ“„ Word'e Organize Kaydet",
        command=self.save_to_word_organized,
        height=30,
        font=ctk.CTkFont(size=12, weight="bold"),
        fg_color="#2E8B57",
        hover_color="#228B22"
    )
    word_save_button.pack(side="right", padx=5)
    
    # Excel export butonu
    export_button = ctk.CTkButton(
        save_frame,
        text="ğŸ“Š Excel'e Aktar",
        command=self.export_to_excel,
        height=30
    )
    export_button.pack(side="right", padx=5)

def select_file(self):
    """Word dosyasÄ± seÃ§me - GÃœNCELLENEN!"""
    file_path = filedialog.askopenfilename(
        title="Word DosyasÄ± SeÃ§in",
        filetypes=[
            ("Word DosyalarÄ±", "*.docx *.doc"),
            ("TÃ¼m Dosyalar", "*.*")
        ]
    )
    
    if file_path:
        self.current_file_path = file_path
        file_name = os.path.basename(file_path)
        self.file_path_label.configure(text=f"SeÃ§ilen: {file_name}")
        
        # YENÄ°: Dosya bilgilerini Ã§Ä±kar (henÃ¼z WordReader yaratmadan)
        from services.word_reader import WordReaderService
        temp_reader = WordReaderService()
        file_info = temp_reader.extract_file_info(file_path)
        
        # Proje bilgilerini gÃ¼ncelle
        self.update_project_info_display(file_info)
        
        self.process_button.configure(state="normal")

def update_project_info_display(self, file_info: dict):
    """Proje bilgileri gÃ¶stergesini gÃ¼ncelle - YENÄ°!"""
    part_no = file_info.get('part_no', 'Unknown')
    operation_no = file_info.get('operation_no', '00')
    
    info_text = f"Part: {part_no} | Op: {operation_no}"
    self.project_info_label.configure(text=info_text, text_color="#ffb74d")

def process_file(self):
    """DosyayÄ± iÅŸler - GÃœNCELLENEN proje dialog ile!"""
    if not self.current_file_path:
        messagebox.showerror("Hata", "Ã–nce bir dosya seÃ§in!")
        return
    
    try:
        # 1. Word servisini baÅŸlat ve dosya bilgilerini Ã§Ä±kar
        word_service = WordReaderService()
        
        # 2. Proje bilgileri dialog'unu gÃ¶ster
        from ui.project_info_dialog import ProjectInfoDialog
        
        # Dosyadan Ã§Ä±karÄ±lan bilgileri al
        file_info = word_service.extract_file_info(self.current_file_path)
        
        # Dialog'u aÃ§
        dialog = ProjectInfoDialog(
            self, 
            operation_no=file_info.get('operation_no', ''),
            part_no=file_info.get('part_no', '')
        )
        self.wait_window(dialog)
        
        # Dialog sonucunu kontrol et
        if not dialog.result:
            # Ä°ptal edildi
            return
        
        # Proje bilgilerini sakla
        self.project_info = dialog.result
        print(f"âœ“ Proje bilgileri alÄ±ndÄ±: {self.project_info}")
        
        # Proje bilgilerini gÃ¶stergede gÃ¼ncelle
        project_text = f"Proje: {self.project_info['project']} | Seri: {self.project_info['serial_no']}"
        self.project_info_label.configure(text=project_text, text_color="#4fc3f7")
        
        self.file_path_label.configure(text="Ä°ÅŸleniyor...")
        self.update()
        
        # 3. Data processor ile DataFrame oluÅŸtur
        df = DataProcessorService.from_word_tables(word_service, self.current_file_path)
        
        if df.empty:
            messagebox.showwarning("UyarÄ±", "GeÃ§erli veri bulunamadÄ±!")
            return
        
        # 4. Model objelerine dÃ¶nÃ¼ÅŸtÃ¼r
        data_service = DataProcessorService()
        self.karakterler = data_service.process_dataframe(df)
        
        if not self.karakterler:
            messagebox.showwarning("UyarÄ±", "GeÃ§erli karakter bulunamadÄ±!")
            return
        
        # 5. Word Save As servisi iÃ§in orijinal dosyayÄ± yÃ¼kle
        self.word_save_service.load_original_document(self.current_file_path)
        
        # 6. DokÃ¼manÄ± saÄŸ panelde gÃ¶ster
        self.document_viewer.load_document(self.current_file_path)
        
        # 7. Ä°lk karakteri gÃ¶ster
        self.current_index = 0
        self.show_current_karakter()
        self.update_navigation()
        self.update_stats()
        
        file_name = os.path.basename(self.current_file_path)
        self.file_path_label.configure(text=f"âœ“ YÃ¼klendi: {file_name}")
        
        success_msg = f"""âœ… BaÅŸarÄ±yla yÃ¼klendi!
```

ğŸ“Š Veri: {len(self.karakterler)} karakter
ğŸ“‹ Proje: {self.project_info[â€˜projectâ€™]}
ğŸ·ï¸ Seri: {self.project_info[â€˜serial_noâ€™]}
ğŸ”§ Part: {self.project_info[â€˜part_noâ€™]}
âš™ï¸ Operation: {self.project_info[â€˜operation_noâ€™]}

Ok tuÅŸlarÄ± ile navigate edebilirsiniz.â€â€â€

```
        messagebox.showinfo("BaÅŸarÄ±lÄ±", success_msg)
        
    except Exception as e:
        messagebox.showerror("Hata", f"Ä°ÅŸleme hatasÄ±:\n{str(e)}")
        print(f"Ä°ÅŸleme hatasÄ±: {e}")

def save_to_word_organized(self):
    """Ã–lÃ§Ã¼m deÄŸerleriyle Word dosyasÄ±nÄ± organize klasÃ¶re kaydetme - YENÄ°!"""
    if not self.karakterler:
        messagebox.showwarning("UyarÄ±", "Ã–nce veri yÃ¼kleyin!")
        return
    
    if not self.project_info:
        messagebox.showwarning("UyarÄ±", "Proje bilgileri eksik! Ã–nce dosyayÄ± yÃ¼kleyin.")
        return
    
    if not hasattr(self, 'word_save_service') or not self.word_save_service.current_document:
        messagebox.showerror("Hata", "Word servisi hazÄ±r deÄŸil! Ã–nce dosyayÄ± yÃ¼kleyin.")
        return
    
    try:
        # Ä°statistikleri gÃ¶ster (tolerans bilgileri dahil)
        stats = self.word_save_service.get_statistics(self.karakterler)
        
        # Hedef klasÃ¶r yolunu kullanÄ±cÄ±dan al
        base_folder = filedialog.askdirectory(
            title="Kaydetme KlasÃ¶rÃ¼nÃ¼ SeÃ§in",
            mustexist=True
        )
        
        if not base_folder:
            return
        
        # Organize yol oluÅŸtur
        from services.word_reader import WordReaderService
        temp_reader = WordReaderService()
        temp_reader.part_no = self.project_info['part_no']
        temp_reader.operation_no = self.project_info['operation_no']
        
        organized_path = temp_reader.create_organized_path(
            base_folder,
            self.project_info['project'],
            self.project_info['serial_no']
        )
        
        # KullanÄ±cÄ±ya detaylÄ± bilgi ver
        info_msg = f"""ğŸ“ Organize kaydetme iÅŸlemi:
```

ğŸ“Š Ä°statistikler:
â€¢ Toplam karakter: {stats[â€˜totalâ€™]}
â€¢ Ã–lÃ§Ã¼len karakter: {stats[â€˜measuredâ€™]}
â€¢ Bekleyen karakter: {stats[â€˜unmeasuredâ€™]}
â€¢ Tamamlanma oranÄ±: %{stats[â€˜completion_percentageâ€™]:.1f}

ğŸ¯ Tolerans KontrolÃ¼:
â€¢ Tolerans iÃ§i: {stats[â€˜tolerance_compliantâ€™]}
â€¢ Tolerans dÄ±ÅŸÄ±: {stats[â€˜tolerance_violationsâ€™]} ğŸŸ¡
â€¢ Tolerans tanÄ±msÄ±z: {stats[â€˜no_tolerance_definedâ€™]}

ğŸ“ Hedef Yol:
{organized_path}

ğŸŸ¡ Tolerans dÄ±ÅŸÄ± deÄŸerler sarÄ± marker ile iÅŸaretlenecek!

Devam etmek istiyor musunuz?â€â€â€

```
        result = messagebox.askyesno("Organize Word Kaydetme", info_msg)
        
        if not result:
            return
        
        # Progress gÃ¶stergesi
        self.file_path_label.configure(text="Organize klasÃ¶re kaydediliyor...")
        self.update()
        
        # Word Save As iÅŸlemini gerÃ§ekleÅŸtir (organize yol ile)
        saved_path = self.word_save_service.save_with_actual_values(
            self.karakterler,
            save_path=organized_path
        )
        
        # BaÅŸarÄ± mesajÄ± (tolerans bilgileri dahil)
        tolerance_info = ""
        if stats['tolerance_violations'] > 0:
            tolerance_info = f"\nğŸŸ¡ {stats['tolerance_violations']} tolerans dÄ±ÅŸÄ± deÄŸer sarÄ± marker ile iÅŸaretlendi!"
        
        success_msg = f"""âœ… Word dosyasÄ± organize klasÃ¶re kaydedildi!
```

ğŸ“ Konum: {saved_path}

ğŸ“‚ KlasÃ¶r YapÄ±sÄ±:
â””â”€â”€ {self.project_info[â€˜projectâ€™]}/
â””â”€â”€ {self.project_info[â€˜serial_noâ€™]}/
â””â”€â”€ {self.project_info[â€˜part_noâ€™]}_{self.project_info[â€˜operation_noâ€™]}_measurements.docx

ğŸ“Š AktarÄ±lan veriler:
â€¢ {stats[â€˜measuredâ€™]} Ã¶lÃ§Ã¼m deÄŸeri Word tablosuna yazÄ±ldÄ±
â€¢ Orijinal formatlar korundu
â€¢ ACTUAL kolonu gÃ¼ncellendi{tolerance_info}

ğŸ¯ Tolerans KontrolÃ¼:
â€¢ âœ… {stats[â€˜tolerance_compliantâ€™]} deÄŸer tolerans iÃ§inde
â€¢ ğŸŸ¡ {stats[â€˜tolerance_violationsâ€™]} deÄŸer tolerans dÄ±ÅŸÄ± (sarÄ± iÅŸaretli)

Kaydedilen dosyayÄ± aÃ§mak istiyor musunuz?â€â€â€

```
        open_file = messagebox.askyesno("BaÅŸarÄ±lÄ±", success_msg)
        
        if open_file:
            try:
                os.startfile(saved_path)  # Windows
            except:
                try:
                    os.system(f'open "{saved_path}"')  # macOS
                except:
                    os.system(f'xdg-open "{saved_path}"')  # Linux
        
        # Dosya yolu labelÄ±nÄ± geri getir
        file_name = os.path.basename(self.current_file_path) if self.current_file_path else ""
        self.file_path_label.configure(text=f"âœ“ YÃ¼klendi: {file_name}")
        
    except Exception as e:
        error_msg = f"Organize Word kaydetme hatasÄ±:\n{str(e)}"
        messagebox.showerror("Hata", error_msg)
        print(f"Organize Word kaydetme hatasÄ±: {e}")
        
        # Dosya yolu labelÄ±nÄ± geri getir
        file_name = os.path.basename(self.current_file_path) if self.current_file_path else ""
        self.file_path_label.configure(text=f"âœ“ YÃ¼klendi: {file_name}")

def show_current_karakter(self):
    """Mevcut karakteri gÃ¶sterir"""
    if 0 <= self.current_index < len(self.karakterler):
        karakter = self.karakterler[self.current_index]
        self.karakter_view.load_karakter(karakter)
        print(f"Karakter gÃ¶steriliyor: {self.current_index + 1}/{len(self.karakterler)} - {karakter.item_no}")

def navigate_to(self, new_index: int):
    """Belirtilen indekse navigate eder"""
    if not self.karakterler:
        return
    
    if 0 <= new_index < len(self.karakterler):
        self.current_index = new_index
        self.show_current_karakter()
        self.update_navigation()
        print(f"Navigate: {self.current_index + 1}/{len(self.karakterler)}")

def update_navigation(self):
    """Navigasyon durumunu gÃ¼nceller"""
    if self.karakterler:
        self.navigation_panel.update_navigation(self.current_index, len(self.karakterler))

def on_karakter_updated(self, karakter: TeknikResimKarakteri):
    """Karakter gÃ¼ncellendiÄŸinde Ã§aÄŸrÄ±lÄ±r"""
    print(f"Karakter gÃ¼ncellendi: {karakter.item_no} = {karakter.actual}")
    self.update_stats()

def update_stats(self):
    """Ä°statistikleri gÃ¼nceller"""
    if not self.karakterler:
        return
    
    # Ã–lÃ§Ã¼m durumu
    total = len(self.karakterler)
    measured = len([k for k in self.karakterler if k.actual])
    unmeasured = total - measured
    
    # Mevcut karakter bilgisi
    current_info = f"Åu an: {self.current_index + 1}/{total}"
    
    # Ä°statistik metni
    stats_text = f"{current_info} | Toplam: {total} | Ã–lÃ§Ã¼len: {measured} | Bekleyen: {unmeasured}"
    
    if total > 0:
        percentage = (measured / total) * 100
        stats_text += f" | Tamamlanan: %{percentage:.1f}"
    
    # Proje bilgisi varsa ekle
    if self.project_info:
        stats_text += f" | ğŸ“‹ {self.project_info['project']}"
    
    self.stats_label.configure(text=stats_text)

def export_to_excel(self):
    """SonuÃ§larÄ± Excel'e aktarÄ±r"""
    if not self.karakterler:
        messagebox.showwarning("UyarÄ±", "Ã–nce veri yÃ¼kleyin!")
        return
    
    try:
        # Excel dosyasÄ± yolu seÃ§
        file_path = filedialog.asksaveasfilename(
            title="Excel DosyasÄ± Kaydet",
            defaultextension=".xlsx",
            filetypes=[("Excel DosyalarÄ±", "*.xlsx"), ("TÃ¼m Dosyalar", "*.*")]
        )
        
        if file_path:
            import pandas as pd
            
            # DataFrame oluÅŸtur
            data = []
            for karakter in self.karakterler:
                row_data = {
                    'Item No': karakter.item_no,
                    'Dimension': karakter.dimension,
                    'Tooling': karakter.tooling,
                    'BP Zone': karakter.bp_zone,
                    'Remarks': karakter.remarks,
                    'Inspection Level': karakter.inspection_level,
                    'Actual': karakter.actual,
                    'Badge': karakter.badge
                }
                
                # Parsed dimension bilgileri varsa ekle
                if hasattr(karakter, 'tolerance_type') and karakter.tolerance_type:
                    row_data['Tolerance Type'] = karakter.tolerance_type
                if hasattr(karakter, 'nominal_value') and karakter.nominal_value is not None:
                    row_data['Nominal Value'] = karakter.nominal_value
                if hasattr(karakter, 'upper_limit') and karakter.upper_limit is not None:
                    row_data['Upper Limit'] = karakter.upper_limit
                if hasattr(karakter, 'lower_limit') and karakter.lower_limit is not None:
                    row_data['Lower Limit'] = karakter.lower_limit
                
                # Proje bilgileri varsa ekle
                if self.project_info:
                    row_data['Project'] = self.project_info['project']
                    row_data['Serial No'] = self.project_info['serial_no']
                    row_data['Part No'] = self.project_info['part_no']
                    row_data['Operation No'] = self.project_info['operation_no']
                
                data.append(row_data)
            
            df = pd.DataFrame(data)
            df.to_excel(file_path, index=False)
            
            messagebox.showinfo("BaÅŸarÄ±lÄ±", f"Veriler Excel'e aktarÄ±ldÄ±:\n{file_path}")
            
    except Exception as e:
        messagebox.showerror("Hata", f"Excel aktarÄ±m hatasÄ±:\n{str(e)}")
```
