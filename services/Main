#!/usr/bin/env python3
â€œâ€â€
Teknik Resim Karakter Okuyucu - Ana BaÅŸlatma DosyasÄ±
â€œâ€â€

import sys
import os
import traceback

# Proje kÃ¶k dizinini Python pathâ€™ine ekle

current_dir = os.path.dirname(os.path.abspath(**file**))
sys.path.insert(0, current_dir)

try:
import customtkinter as ctk
from tkinter import messagebox

```
# UI modÃ¼lÃ¼nÃ¼ import et
from ui.main_window import NavigableMainWindow

def main():
    """Ana uygulama fonksiyonu"""
    try:
        print("ğŸš€ Teknik Resim Karakter Okuyucu baÅŸlatÄ±lÄ±yor...")
        
        # CustomTkinter tema ayarlarÄ±
        ctk.set_appearance_mode("dark")  # "dark", "light", "system"
        ctk.set_default_color_theme("blue")  # "blue", "green", "dark-blue"
        
        print("âœ“ CustomTkinter tema ayarlandÄ±")
        
        # Ana pencereyi oluÅŸtur ve baÅŸlat
        app = NavigableMainWindow()
        
        print("âœ“ Ana pencere oluÅŸturuldu")
        print("ğŸ“‹ Program hazÄ±r! Dosya seÃ§erek baÅŸlayabilirsiniz.")
        
        # UygulamayÄ± baÅŸlat
        app.mainloop()
        
    except Exception as e:
        error_msg = f"""
```

ğŸš¨ Uygulama baÅŸlatma hatasÄ±:

Hata: {str(e)}

Detaylar:
{traceback.format_exc()}

LÃ¼tfen:

1. Gerekli kÃ¼tÃ¼phanelerin yÃ¼klÃ¼ olduÄŸunu kontrol edin
1. Python sÃ¼rÃ¼mÃ¼nÃ¼zÃ¼n 3.8+ olduÄŸunu doÄŸrulayÄ±n
1. Dosya izinlerini kontrol edin
   â€œâ€â€
   
   ```
        print(error_msg)
        
        # GUI hata mesajÄ± (eÄŸer tkinter Ã§alÄ±ÅŸÄ±yorsa)
        try:
            messagebox.showerror("BaÅŸlatma HatasÄ±", f"Uygulama baÅŸlatÄ±lamadÄ±:\n\n{str(e)}")
        except:
            pass
        
        sys.exit(1)
   ```
   
   def check_dependencies():
   â€œâ€â€œGerekli kÃ¼tÃ¼phaneleri kontrol etâ€â€â€
   required_packages = [
   (â€˜customtkinterâ€™, â€˜CustomTkinterâ€™),
   (â€˜docxâ€™, â€˜python-docxâ€™),
   (â€˜pandasâ€™, â€˜pandasâ€™),
   (â€˜mammothâ€™, â€˜mammothâ€™),
   ]
   
   ```
    missing_packages = []
    
    for package, display_name in required_packages:
        try:
            __import__(package)
            print(f"âœ“ {display_name} bulundu")
        except ImportError:
            missing_packages.append(display_name)
            print(f"âœ— {display_name} bulunamadÄ±")
    
    if missing_packages:
        error_msg = f"""
   ```

ğŸš¨ Eksik KÃ¼tÃ¼phaneler:

AÅŸaÄŸÄ±daki kÃ¼tÃ¼phaneler eksik:
{chr(10).join(fâ€â€¢ {pkg}â€ for pkg in missing_packages)}

YÃ¼klemek iÃ§in:
pip install {â€™ â€™.join(missing_packages)}

Veya:
pip install customtkinter python-docx pandas mammoth
â€œâ€â€
print(error_msg)

```
        try:
            messagebox.showerror("Eksik KÃ¼tÃ¼phaneler", 
                f"Eksik kÃ¼tÃ¼phaneler:\n\n{chr(10).join(missing_packages)}\n\n"
                "LÃ¼tfen gerekli kÃ¼tÃ¼phaneleri yÃ¼kleyin.")
        except:
            pass
        
        return False
    
    return True

if __name__ == "__main__":
    print("=" * 60)
    print("ğŸ”§ Teknik Resim Karakter Okuyucu v2.0")
    print("   ğŸ“„ Word Save As + Tolerance Control + Project Organization")
    print("=" * 60)
    
    # KÃ¼tÃ¼phane kontrolÃ¼
    print("\nğŸ“¦ KÃ¼tÃ¼phane kontrolÃ¼ yapÄ±lÄ±yor...")
    if not check_dependencies():
        print("\nâŒ KÃ¼tÃ¼phane kontrolÃ¼ baÅŸarÄ±sÄ±z!")
        input("Devam etmek iÃ§in Enter'a basÄ±n...")
        sys.exit(1)
    
    print("\nâœ… TÃ¼m kÃ¼tÃ¼phaneler mevcut!")
    print("\nğŸš€ Uygulama baÅŸlatÄ±lÄ±yor...\n")
    
    # Ana uygulamayÄ± baÅŸlat
    main()
```

except ImportError as e:
print(fâ€â€â€
ğŸš¨ IMPORT HATASI:

{str(e)}

LÃ¼tfen aÅŸaÄŸÄ±daki kÃ¼tÃ¼phaneleri yÃ¼kleyin:

pip install customtkinter python-docx pandas mammoth

Opsiyonel (HTML gÃ¶rÃ¼ntÃ¼leme iÃ§in):
pip install tkinterweb
â€œâ€â€)

```
input("Devam etmek iÃ§in Enter'a basÄ±n...")
sys.exit(1)
```

except Exception as e:
print(fâ€â€â€
ğŸš¨ BEKLENMEYEN HATA:

{str(e)}

Detaylar:
{traceback.format_exc()}
â€œâ€â€)

```
input("Devam etmek iÃ§in Enter'a basÄ±n...")
sys.exit(1)
```
